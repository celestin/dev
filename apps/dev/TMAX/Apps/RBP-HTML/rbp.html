<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Risk Based Prioritisation</title>
<script language="Javascript">
  // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  // Risk Based Prioritisation
  // Copyright (c) 2012 Talisman Energy UK Ltd
  // Author Craig McKay
  // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  var tdLhood = null;
  var tdConsd = null;
  var sPear = '';
  var iSeverity = 0;
  var sLhood = '';

  var rr = new Array();
  rr['A1'] = 4;  rr['B1'] = 4;  rr['C1'] = 3;  rr['D1'] = 3;  rr['E1'] = 2;
  rr['A2'] = 4;  rr['B2'] = 3;  rr['C2'] = 3;  rr['D2'] = 2;  rr['E2'] = 2;
  rr['A3'] = 3;  rr['B3'] = 3;  rr['C3'] = 2;  rr['D3'] = 2;  rr['E3'] = 1;
  rr['A4'] = 3;  rr['B4'] = 2;  rr['C4'] = 2;  rr['D4'] = 1;  rr['E4'] = 1;
  rr['A5'] = 2;  rr['B5'] = 2;  rr['C5'] = 1;  rr['D5'] = 1;  rr['E5'] = 1;

  function copyToClipboard() {
    if (window.clipboardData && clipboardData.setData)
    {
	  var txtRisk=document.getElementById("txtRisk");
	  var txtJust=document.getElementById("txtJust");
	  var txtMit=document.getElementById("txtMit");

	  var s = "============================================================\n" +
	    "Risk Ranking  | " + txtRisk.value + "\n" +
		"Justification | " + txtJust.value + "\n" +
		"Mitigation    | " + txtMit.value + "\n" +
		"============================================================\n";
      clipboardData.setData("Text", s);
	}
  }

  function getDate(iAddDays) {
	var now = new Date();
	if (iAddDays > 0) now = new Date(now.getTime() + (iAddDays*24*60*60*1000));
	return ('0' + now.getDate()).slice(-2) + '/'
             + ('0' + (now.getMonth()+1)).slice(-2) + '/'
             + now.getFullYear();
  }

  function calcPriority() {
	if (sPear != '' && iSeverity > 0 && sLhood != '') {
	  var txtPriority=document.getElementById("txtPriority");
	  var txtRisk=document.getElementById("txtRisk");
	  var txtTS=document.getElementById("txtTS");
	  var txtTF=document.getElementById("txtTF");
	  var prio = rr[sLhood + iSeverity];

	  txtPriority.value = prio;
	  txtRisk.value = sPear + iSeverity + sLhood;

      if (prio == 1) {
	    txtTS.value = getDate(0);    txtTF.value = getDate(30);
	  } else if (prio == 2) {
	    txtTS.value = getDate(30);   txtTF.value = getDate(90);
	  } else if (prio == 3) {
	    txtTS.value = getDate(90);   txtTF.value = getDate(180);
	  } else {
	    txtTS.value = getDate(180);  txtTF.value = getDate(360);
	  }
	}
  }

  function setPearSeverity(td, pear, severity) {
    if (tdConsd != null) tdConsd.className = "consd";
    td.className = "consdsel";

	sPear = pear;
	iSeverity = severity;

    tdConsd = td;
	calcPriority();
  }

  function setLikelihood(td, lhood) {
    if (tdLhood != null) tdLhood.className = "lhood";
    td.className = "lhoodsel";

	sLhood = lhood;

    tdLhood = td;
	calcPriority();
  }

</script>
<style>
  body, p, a, td, th, h1 {
    font-family: "Arial";
  }

  .hdr {
    font-size: 14pt;
    font-weight: bold;
    text-align: center;
  }

  .desc {
    font-size: 10pt;
    text-align: center;
  }

  .code {
    font-size: 12pt;
    font-weight: bold;
    text-align: center;
  }

  .lhood {
    font-size: 12pt;
    font-weight: bold;
    text-align: center;
  }

  .lhood:hover {
    background-color: #a4b9e1;
  }

  .lhoodsel {
    font-size: 12pt;
    font-weight: bold;
    text-align: center;
    color: white;
    background-color: #587bbd;
  }


  .consd {
    font-size: 9pt;
    text-align: center;
  }

  .consd:hover {
    background-color: #d69cc9;
  }

  .consdsel {
    font-size: 9pt;
    text-align: center;
    color: white;
    background-color: #77005d;
  }


  .review {
    font-size: 12pt;
    background-color: #52c9ed;
    text-align: center;
  }

  .tlgreen {
    background-color: #a6ce39;
    text-align: center;
  }

  .tlyell {
    background-color: #FFFF00;
    text-align: center;
  }

  .tlamb {
    background-color: #fdba12;
    text-align: center;
  }

  .tlred {
    background-color: #f26331;
    text-align: center;
  }

</style>
</head>
<body>
<table border="1" cellpadding="1" cellspacing="0">

  <tr>
    <td class="hdr" colspan="4">Consequence</td>
    <td class="hdr" rowspan="4">Severity</td>
    <td class="hdr" colspan="5">Likelihood<br />of Consequence Occuring</td>
  </tr>

  <tr>
    <td class="desc" width="110">People<br />Safety</td>
    <td class="desc" width="110">Environmental</td>
    <td class="desc" width="110">Asset</td>
    <td class="desc" width="110">Reputation</td>

    <td class="desc" width="75">&gt; 12 months</td>
    <td class="desc" width="75">3 to 12 months</td>
    <td class="desc" width="75">2 weeks to 3 months</td>
    <td class="desc" width="75">2 days to 2 weeks</td>
    <td class="desc" width="75">Occurring NOW or likely to occur within 2 days</td>
  </tr>

  <tr height="50">
    <td class="code">P</td>
    <td class="code">E</td>
    <td class="code">A</td>
    <td class="code">R</td>

    <td class="lhood" onClick="setLikelihood(this, 'A');return true;">A</td>
    <td class="lhood" onClick="setLikelihood(this, 'B');return true;">B</td>
    <td class="lhood" onClick="setLikelihood(this, 'C');return true;">C</td>
    <td class="lhood" onClick="setLikelihood(this, 'D');return true;">D</td>
    <td class="lhood" onClick="setLikelihood(this, 'E');return true;">E</td>
  </tr>

  <tr>
    <td class="consd">No Injury</td>
    <td class="consd">No Impact</td>
    <td class="consd">No Damage<br />No Deferment<br />&pound;0</td>
    <td class="consd">No Interest</td>

    <td class="review" colspan="5">A review is required to progress this work</td>
  </tr>

  <tr height="75">
    <td class="consd" onClick="setPearSeverity(this, 'P', 1);return true;">Slight Injury or Health Effect.<br />Non Reportable Injury.</td>
    <td class="consd" onClick="setPearSeverity(this, 'E', 1);return true;">Slight Impact.</td>
    <td class="consd" onClick="setPearSeverity(this, 'A', 1);return true;">Slight Damage.<br />Slight Deferment.<br />&lt;&pound;100k</td>
    <td class="consd" onClick="setPearSeverity(this, 'R', 1);return true;">Scrutiny from Internal Auditor &mdash; ICP Action.</td>

    <td class="code">1</td>
    <td class="tlgreen">4</td>
    <td class="tlgreen">4</td>
    <td class="tlyell">3</td>
    <td class="tlyell">3</td>
    <td class="tlamb">2</td>
  </tr>

  <tr height="75">
    <td class="consd" onClick="setPearSeverity(this, 'P', 2);return true;">Minor Injury or Health Effect.</td>
    <td class="consd" onClick="setPearSeverity(this, 'E', 2);return true;">Minor Impact.<br />Localised Effect Temporary Containment.</td>
    <td class="consd" onClick="setPearSeverity(this, 'A', 2);return true;">Minor Damage.<br />Minor Deferment.<br />&gt;&pound;100k &lt;&pound;1m</td>
    <td class="consd" onClick="setPearSeverity(this, 'R', 2);return true;">Internal Reputation Impact &mdash; Internal Company Investigation.</td>

    <td class="code">2</td>
    <td class="tlgreen">4</td>
    <td class="tlyell">3</td>
    <td class="tlyell">3</td>
    <td class="tlamb">2</td>
    <td class="tlamb">2</td>
  </tr>

  <tr height="75">
    <td class="consd" onClick="setPearSeverity(this, 'P', 3);return true;">Moderate Health Effect Serious Injury.<br />Lost Time Incident.</td>
    <td class="consd" onClick="setPearSeverity(this, 'E', 3);return true;">Moderate Impact.<br />Recoverable Environmental Loss.</td>
    <td class="consd" onClick="setPearSeverity(this, 'A', 3);return true;">Moderate Damage.<br />Moderate Deferment.<br />&gt;&pound;1m &lt;&pound;10m</td>
    <td class="consd" onClick="setPearSeverity(this, 'R', 3);return true;">Local Reputation Impact &mdash; External Regulatory Body &mdash; Improvement Notice</td>


    <td class="code">3</td>
    <td class="tlyell">3</td>
    <td class="tlyell">3</td>
    <td class="tlamb">2</td>
    <td class="tlamb">2</td>
    <td class="tlred">1</td>
  </tr>

  <tr height="75">
    <td class="consd" onClick="setPearSeverity(this, 'P', 4);return true;">Major Health Effect.<br />Multiple Serious Injuries.</td>
    <td class="consd" onClick="setPearSeverity(this, 'E', 4);return true;">Major Impact.<br />Severe Damage Resulting in Permanent Effect.</td>
    <td class="consd" onClick="setPearSeverity(this, 'A', 4);return true;">Major Damage.<br />Major Deferment.<br />&gt;&pound;10m &lt;&pound;30m</td>
    <td class="consd" onClick="setPearSeverity(this, 'R', 4);return true;">National Reputaion Impact &mdash; External Regulatory Body &mdash; Prohibition Notice.</td>


    <td class="code">4</td>
    <td class="tlyell">3</td>
    <td class="tlamb">2</td>
    <td class="tlamb">2</td>
    <td class="tlred">1</td>
    <td class="tlred">1</td>
  </tr>


  <tr height="75">
    <td class="consd" onClick="setPearSeverity(this, 'P', 5);return true;">Fatality.</td>
    <td class="consd" onClick="setPearSeverity(this, 'E', 5);return true;">Massive Impact.<br />Widespread Chronic Effect.</td>
    <td class="consd" onClick="setPearSeverity(this, 'A', 5);return true;">Massive Damage.<br />Massive Deferment.<br />&gt;&pound;30m</td>
    <td class="consd" onClick="setPearSeverity(this, 'R', 5);return true;">International Reputation Impact &mdash; External Regulatory Body &mdash; Prosecution.</td>

    <td class="code">5</td>
    <td class="tlamb">2</td>
    <td class="tlamb">2</td>
    <td class="tlred">1</td>
    <td class="tlred">1</td>
    <td class="tlred">1</td>
  </tr>

</table>

<table border="0" cellpadding="5" cellspacing="0">
  <tr>
    <td>Priority</td><td><input name="txtPriority" id="txtPriority" size=4 value="" readonly="readonly"></td>
    <td>Risk&nbsp;Ranking</td><td width="120"><input name="txtRisk" id="txtRisk" size=8 value="" readonly="readonly"></td>
	<td><input type="button" value="Copy Risk" onClick="copyToClipboard();"></td>
	<td>Target Start</td><td><input name="txtTS" id="txtTS" size="8" value="" readonly="readonly"></td>
	<td>Target Finish</td><td><input name="txtTF" id="txtTF" size="8" value="" readonly="readonly"></td>
  </tr><tr>
    <td>Justification</td><td colspan="8"><textarea rows="4" cols="100" name="txtJust" id="txtJust"></textarea></td>
  </tr><tr>
    <td>Mitigation</td><td colspan="8"><textarea rows="4" cols="100" name="txtMit" id="txtMit"></textarea></td>
  </tr>
</table>

</body>
</html>